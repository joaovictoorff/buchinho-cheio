<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="src/styles/alimentos_doaveis.css">
    <link rel="stylesheet" href="src/styles/styles.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://unpkg.com/scrollreveal"></script>
    <title>Buchinho Cheio</title>
</head>
<body>
    
<div class="container">
    <div class="item">
        <img src="src/images/cafe.png" alt="Café">
        <p>Café</p>
        <div class="controls">
            <input type="number" value="0" min="0" id="quantidade-cafe">
            <input type="button" value="Adicionar" onclick="adicionarAoCarrinho('cafe', 'Café')">
        </div>
    </div>
    <div class="item">
        <img src="src/images/arroz.png" alt="Arroz">
        <p>Arroz</p>
        <div class="controls">
            <input type="number" value="0" min="0" id="quantidade-arroz">
            <input type="button" value="Adicionar" onclick="adicionarAoCarrinho('arroz', 'Arroz')">
        </div>
    </div>
    <div class="item">
        <img src="src/images/feijao.png" alt="Feijão">
        <p>Feijão</p>
        <div class="controls">
            <input type="number" value="0" min="0" id="quantidade-feijao">
            <input type="button" value="Adicionar" onclick="adicionarAoCarrinho('feijao', 'Feijão')">
        </div>
    </div>
    <div class="item">
        <img src="src/images/macarrao.png" alt="Macarrão">
        <p>Macarrão</p>
        <div class="controls">
            <input type="number" value="0" min="0" id="quantidade-macarrao">
            <input type="button" value="Adicionar" onclick="adicionarAoCarrinho('macarrao', 'Macarrão')">
        </div>
    </div>
    <div class="item">
        <img src="src/images/acucar.png" alt="Açúcar">
        <p>Açúcar</p>
        <div class="controls">
            <input type="number" value="0" min="0" id="quantidade-acucar">
            <input type="button" value="Adicionar" onclick="adicionarAoCarrinho('acucar', 'Açúcar')">
        </div>
    </div>
    <div class="item">
        <img src="src/images/farinha.png" alt="Farinha de trigo">
        <p>Farinha de trigo</p>
        <div class="controls">
            <input type="number" value="0" min="0" id="quantidade-farinha">
            <input type="button" value="Adicionar" onclick="adicionarAoCarrinho('farinha', 'Farinha de trigo')">
        </div>
    </div>
    <div class="item">
        <img src="src/images/milho.png" alt="Milho">
        <p>Milho</p>
        <div class="controls">
            <input type="number" value="0" min="0" id="quantidade-milho">
            <input type="button" value="Adicionar" onclick="adicionarAoCarrinho('milho', 'Milho')">
        </div>
    </div>
    <div class="item">
        <img src="src/images/sardinha.png" alt="Sardinha">
        <p>Sardinha</p>
        <div class="controls">
            <input type="number" value="0" min="0" id="quantidade-sardinha">
            <input type="button" value="Adicionar" onclick="adicionarAoCarrinho('sardinha', 'Sardinha')">
        </div>
    </div>
    <div class="item">
        <img src="src/images/oleo.png" alt="Óleo">
        <p>Óleo</p>
        <div class="controls">
            <input type="number" value="0" min="0" id="quantidade-oleo">
            <input type="button" value="Adicionar" onclick="adicionarAoCarrinho('oleo', 'Óleo')">
        </div>
    </div>
    <div class="item">
        <img src="src/images/sabonete.png" alt="Sabonete">
        <p>Sabonete</p>
        <div class="controls">
            <input type="number" value="0" min="0" id="quantidade-sabonete">
            <input type="button" value="Adicionar" onclick="adicionarAoCarrinho('sabonete', 'Sabonete')">
        </div>
    </div>
    <div class="item">
        <img src="src/images/pasta.png" alt="Pasta de dente">
        <p>Pasta de dente</p>
        <div class="controls">
            <input type="number" value="0" min="0" id="quantidade-pasta">
            <input type="button" value="Adicionar" onclick="adicionarAoCarrinho('pasta', 'Pasta de dente')">
        </div>
    </div>
    <div class="item">
        <img src="src/images/escova.png" alt="Escova de dente">
        <p>Escova de dente</p>
        <div class="controls">
            <input type="number" value="0" min="0" id="quantidade-escova">
            <input type="button" value="Adicionar" onclick="adicionarAoCarrinho('escova', 'Escova de dente')">
        </div>
    </div>
</div>

<!-- Modal para o Carrinho -->
<div id="modal">
    <div id="modal-content">
        <div id="modal-header">
            <h3>Carrinho</h3>
            <span onclick="fecharModal()">&times;</span>
        </div>
        <div id="modal-body">
            <ul id="lista-carrinho"></ul>
        </div>
        <div id="modal-footer">
            <button onclick="fecharModal()">Fechar</button>
            <form id="form-carrinho" method="POST" action="processar_carrinho.php">
                <input type="hidden" name="carrinho" id="input-carrinho">
                <button type="submit">Processar</button> <!-- Botão Processar -->
            </form>
        </div>
    </div>
</div>

<input type="button" value="Ver Carrinho" onclick="abrirModal()" class="ver-carrinho">

<script>
    const carrinho = {};

    function adicionarAoCarrinho(id, nome) {
        const quantidadeInput = document.getElementById(`quantidade-${id}`);
        const quantidade = parseInt(quantidadeInput.value);

        if (!isNaN(quantidade) && quantidade > 0) {
            if (carrinho[id]) {
                carrinho[id].quantidade += quantidade;
            } else {
                carrinho[id] = { nome: nome, quantidade: quantidade };
            }
            atualizarCarrinho();
            quantidadeInput.value = 0; // Limpa o campo após adicionar
        } else {
            alert('Por favor, insira uma quantidade válida.');
        }
    }

    function atualizarCarrinho() {
        const listaCarrinho = document.getElementById('lista-carrinho');
        listaCarrinho.innerHTML = ''; // Limpa a lista antes de atualizar

        for (const item in carrinho) {
            const li = document.createElement('li');
            li.textContent = `${carrinho[item].nome} - ${carrinho[item].quantidade} unidade(s)`;
            
            // Botão para remover item
            const btnRemover = document.createElement('button');
            btnRemover.textContent = 'Remover';
            btnRemover.onclick = function() {
                removerDoCarrinho(item);
            };
            li.appendChild(btnRemover);
            listaCarrinho.appendChild(li);
        }
    }

    function removerDoCarrinho(id) {
        delete carrinho[id]; // Remove o item do carrinho
        atualizarCarrinho(); // Atualiza a lista do carrinho
    }

    function abrirModal() {
        document.getElementById('modal').style.display = 'block';
    }

    function fecharModal() {
        document.getElementById('modal').style.display = 'none';
    }

    function processarCarrinho() {
        if (Object.keys(carrinho).length === 0) {
            alert('O carrinho está vazio!');
            return;
        }
        
        // Atualiza o campo oculto com os dados do carrinho
        document.getElementById('input-carrinho').value = JSON.stringify(carrinho);
        
        // Submete o formulário
        document.getElementById('form-carrinho').submit();
    }

    // Fecha o modal ao clicar fora dele
    window.onclick = function(event) {
        const modal = document.getElementById('modal');
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    }
</script>

</body>
</html>
